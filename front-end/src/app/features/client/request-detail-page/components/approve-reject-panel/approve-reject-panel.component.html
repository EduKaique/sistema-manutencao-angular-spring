<main class="container" *ngIf="request">
  <div class="header">
    <div class="title-section">
      <h2 class="heading_3">Orçamento #{{request.id}}</h2>
      <div class="status-section">
        <span class="status" 
          [class.rejected]="request.status === 'REJEITADA'"
          [class.approved]="request.status === 'APROVADA'"
          [class.pending]="!request.status && hasBudget"
          [class.no-budget]="!request.status && !hasBudget">
          {{getStatusText()}}
        </span>
        <button *ngIf="request.status === 'REJEITADA'" class="rescue-button" (click)="resgatarServico()">
          Resgatar Orçamento
        </button>
      </div>
    </div>
  </div>

  <section class="budget-details" *ngIf="hasBudget">
    <div class="price-highlight">
      <h3>Valor do Serviço</h3>
      <p class="heading_3 price">R$ {{budget?.valor | number:'1.2-2'}}</p>
    </div>

    <div class="info-row" *ngIf="budget?.prazo">
      <div class="info-block">
        <h3>Prazo de Execução</h3>
        <p class="deadline">{{budget.prazo}}</p>
      </div>
    </div>

    <div class="services-section" *ngIf="budget?.servicos">
      <h3>Serviços Inclusos</h3>
      <p>{{budget.servicos}}</p>
    </div>

    <div *ngIf="request.status === 'REJEITADA'" class="rejection-info">
      <p class="rejection-status">Orçamento Reprovado</p>
      <p class="rejection-reason">{{request.rejectionReason}}</p>
    </div>

    <div *ngIf="request.status === 'APROVADA'" class="approval-info">
      <p class="approval-status">Orçamento Aprovado</p>
      <p class="approval-message">O serviço foi aprovado e será iniciado em breve.</p>
    </div>
  </section>

  <section class="no-budget" *ngIf="!hasBudget">
    <div class="no-budget-message">
      <h3>Aguardando Orçamento</h3>
      <p>Esta solicitação ainda não possui orçamento cadastrado.</p>
    </div>
  </section>

  <div class="action-buttons" *ngIf="!request.status && hasBudget">
    <button class="reject-button" (click)="showRejectModal = true">
      Rejeitar Serviço
    </button>
    <button class="approve-button" (click)="aprovar()">
      Aprovar Serviço
    </button>
  </div>

  <app-reject-modal
    *ngIf="showRejectModal"
    (confirm)="onRejectConfirm($event)"
    (cancel)="onRejectCancel()">
  </app-reject-modal>
</main>